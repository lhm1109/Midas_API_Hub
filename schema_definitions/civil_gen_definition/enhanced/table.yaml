# Enhanced Schema - Table (Spec Tab) Specific Rules
# Enhanced Schemaì˜ Spec Tab í…Œì´ë¸” ë Œë”ë§ ê·œì¹™

version: "1.0"
extends: "./ui-rules.yaml"

# ============================================================================
# Schema Extensions (í™•ì¥ í•„ë“œ ì •ì˜)
# YAMLì—ì„œ í™•ì¥ í•„ë“œë¥¼ ì •ì˜í•˜ì—¬ ì œë„ˆëŸ´í•˜ê²Œ ì²˜ë¦¬
# ============================================================================
schemaExtensions:
  # ìŠ¤í‚¤ë§ˆì—ì„œ ì¶”ì¶œí•  í™•ì¥ í•„ë“œ (ì»´íŒŒì¼ëŸ¬ìš©)
  extractFromSchema:
    # x-uiëŠ” uië¡œ ë³€í™˜í•˜ì—¬ ì €ì¥
    - key: "x-ui"
      targetProperty: "ui"
      transformKey: true  # x- prefix ì œê±°
      
    # ë‚˜ë¨¸ì§€ëŠ” ì›ë³¸ í‚¤ ê·¸ëŒ€ë¡œ ë˜ëŠ” ë³€í™˜
    - key: "x-enum-labels"
      targetProperty: "enumLabels"
      transformKey: true
      
    - key: "x-enum-by-type"
      targetProperty: "enumByType"
      transformKey: true
      
    - key: "x-enum-labels-by-type"
      targetProperty: "enumLabelsByType"
      transformKey: true
      
    - key: "x-node-count-by-type"
      targetProperty: "nodeCountByType"
      transformKey: true
      
    - key: "x-value-constraint"
      targetProperty: "valueConstraint"
      transformKey: true
      
    - key: "x-required-by-type"
      targetProperty: "requiredByType"
      transformKey: true
      
    # ì›ë³¸ í‚¤ ê·¸ëŒ€ë¡œ ìœ ì§€ (passthrough)
    - key: "x-required-when"
      targetProperty: "x-required-when"
      passthrough: true
      
    - key: "x-transport"
      targetProperty: "x-transport"
      passthrough: true
  
  # í…Œì´ë¸”ì— í‘œì‹œí•  ì¡°ê±´ë¶€ í•„ë“œ
  conditional:
    - key: "x-ui.visibleWhen"
      description: "í•„ë“œê°€ í‘œì‹œë  ì¡°ê±´"
      format: "object"  # { fieldName: value }
      displayInTable: true
      displayIcon: "ğŸ“Œ"
      displayLabel: "Visible when"
      displayColor: "#4c9aff"  # íŒŒë€ìƒ‰
      
    - key: "x-ui.hiddenWhen"
      description: "í•„ë“œê°€ ìˆ¨ê²¨ì§ˆ ì¡°ê±´"
      format: "object"
      displayInTable: true
      displayIcon: "ğŸš«"
      displayLabel: "Hidden when"
      displayColor: "#ff4c4c"  # ë¹¨ê°„ìƒ‰
      
    - key: "x-ui.disabledWhen"
      description: "í•„ë“œê°€ ë¹„í™œì„±í™”ë  ì¡°ê±´"
      format: "object"
      displayInTable: true
      displayIcon: "âš ï¸"
      displayLabel: "Disabled when"
      displayColor: "#ffa500"  # ì£¼í™©ìƒ‰
      
    - key: "x-required-when"
      description: "ì¡°ê±´ë¶€ í•„ìˆ˜ í•„ë“œ"
      format: "object"
      displayInTable: true
      displayIcon: "âš ï¸"
      displayLabel: "Required when"
      displayColor: "#ff9d4c"  # ì£¼í™©ìƒ‰
      
    - key: "x-value-constraint.dependsOn"
      description: "ê°’ì´ ë‹¤ë¥¸ í•„ë“œì— ì˜ì¡´"
      format: "object"
      displayInTable: true
      displayIcon: "ğŸ”—"
      displayLabel: "Depends on"
      displayColor: "#9d4cff"  # ë³´ë¼ìƒ‰
  
  # UI ê´€ë ¨ (ì°¸ê³ ìš©, í…Œì´ë¸”ì—ëŠ” ë¯¸í‘œì‹œ)
  ui:
    - key: "x-ui.label"
      description: "í•„ë“œ ë ˆì´ë¸”"
      displayInTable: false
      
    - key: "x-ui.group"
      description: "í•„ë“œ ê·¸ë£¹"
      displayInTable: false
      
    - key: "x-ui.hint"
      description: "í•„ë“œ íŒíŠ¸"
      displayInTable: true
      displayIcon: "ğŸ’¡"
      displayLabel: "Hint"
      displayColor: "#999999"

# ============================================================================
# Table Structure
# í…Œì´ë¸” êµ¬ì¡°
# ============================================================================
tableStructure:
  columns:
    - id: "no"
      header: "No."
      width: "6%"
      align: "center"
    
    - id: "description"
      header: "Description"
      width: "35%"
      align: "left"
    
    - id: "key"
      header: "Key"
      width: "14%"
      align: "left"
    
    - id: "type"
      header: "Value Type"
      width: "10%"
      align: "center"
    
    - id: "default"
      header: "Default"
      width: "10%"
      align: "center"
    
    - id: "required"
      header: "Required"
      width: "25%"
      align: "left"
  
  numbering:
    start: 1
    resetOnSection: false  # EnhancedëŠ” ì—°ì† ë²ˆí˜¸

# ============================================================================
# Section Headers (x-ui.group)
# ì„¹ì…˜ í—¤ë” ë Œë”ë§
# ============================================================================
sectionHeaders:
  enabled: true
  
  style:
    background: "bg-cyan-950/30"
    textColor: "text-cyan-400"
    fontSize: "text-xs"
    fontWeight: "font-semibold"
    padding: "p-2"
    icon: "ğŸ“‹"
  
  colspan: 6

# ============================================================================
# Condition Rows (ì¡°ê±´ë¶€ í•„ë“œ í‘œì‹œ í–‰)
# ì„¹ì…˜ í—¤ë”ì™€ ë™ì¼í•œ ìŠ¤íƒ€ì¼ ì ìš©
# ============================================================================
conditionRows:
  enabled: true
  
  style:
    background: "bg-cyan-950/30"
    textColor: "text-cyan-400"
    fontSize: "text-xs"
    fontWeight: "font-semibold"
    padding: "p-2"
  
  colspan: 6
  
  detectBy:
    - "section"
    - "__section_"

# ============================================================================
# Row Rendering
# í–‰ ë Œë”ë§ ê·œì¹™
# ============================================================================
rowRendering:
  # ì¼ë°˜ í–‰
  standard:
    hover: true
    hoverStyle: "hover:bg-zinc-800/30"
  
  # Description ì»¬ëŸ¼
  description:
    source: "x-ui.label"  # x-ui.label ì‚¬ìš©
    fallback: "key"
    format: "label"
    markdown: true
    
    # Enhanced íŠ¹ì§• í‘œì‹œ
    features:
      # Standard enum
      enum:
        enabled: true
        title: "**Enum Values:**"
        format: "â€¢ {value} - {label}"
        style: "bg-green-50 border-l-4 border-green-500"
      
      # x-enum-by-type (TYPEë³„ enum)
      enumByType:
        enabled: true
        title: "**Enum Values by Type:**"
        format: "*{type}:*\nâ€¢ {value} - {label}"
        style: "bg-blue-50 border-l-4 border-blue-500"
      
      # x-value-constraint
      valueConstraint:
        enabled: true
        title: "**Value Constraints:**"
        format: "â€¢ {type}: {constraint}"
        style: "bg-amber-50 border-l-4 border-amber-500"
        badge: "APP"
      
      # x-node-count-by-type
      nodeCountByType:
        enabled: true
        title: "**Node Count by Type:**"
        format: "â€¢ {type}: {count} nodes"
        style: "bg-purple-50 border-l-4 border-purple-500"
        badge: "APP"
    
    # Validation badges
    validationBadges:
      standard:
        text: "STD"
        className: "text-[9px] px-1.5 py-0.5 rounded bg-blue-900/50 text-blue-300 border border-blue-700/50"
      appLayer:
        text: "APP"
        className: "text-[9px] px-1.5 py-0.5 rounded bg-orange-900/50 text-orange-300 border border-orange-700/50"
  
  # Key ì»¬ëŸ¼
  key:
    format: "\"{key}\""
    style:
      color: "text-blue-400"
      fontFamily: "font-mono"
  
  # Type ì»¬ëŸ¼
  type:
    format: "capitalize"
    arrayFormat: "Array[{itemType}]"
  
  # Default ì»¬ëŸ¼
  default:
    emptyValue: "-"
    format: "raw"
  
  # Required ì»¬ëŸ¼ (TYPEë³„ ìƒì´í•  ìˆ˜ ìˆìŒ)
  required:
    dynamicByType: true  # TYPEë³„ë¡œ ë‹¤ë¥¸ required ìƒíƒœ
    
    # ëª¨ë“  TYPEì— ëŒ€í•´ ê°™ì€ ê²½ìš°
    simple:
      required:
        text: "Required"
        className: "px-2 py-0.5 text-xs rounded bg-red-600/20 text-red-400"
      optional:
        text: "Optional"
        className: "px-2 py-0.5 text-xs rounded bg-zinc-700/50 text-zinc-400"
    
    # TYPEë³„ë¡œ ë‹¤ë¥¸ ê²½ìš°
    complex:
      format: |
        **Required:** {requiredTypes}
        **Optional:** {optionalTypes}
      style: "text-xs"

# ============================================================================
# Nested Fields (children)
# ì¤‘ì²© í•„ë“œ ë Œë”ë§
# ============================================================================
nestedFields:
  enabled: true
  expandable: true
  expandIcon: "â–¼"
  collapseIcon: "â–¶"
  
  style:
    indentation: "pl-8"
    background: "bg-zinc-900/50"
    keyColor: "text-amber-400"
  
  # ì¤‘ì²© í•„ë“œ ë‚´ ì„¹ì…˜ í—¤ë”
  nestedSectionHeader:
    enabled: true
    style:
      background: "bg-blue-950/30"
      textColor: "text-blue-400"

# ============================================================================
# Styling
# í…Œì´ë¸” ìŠ¤íƒ€ì¼
# ============================================================================
styling:
  table:
    border: true
    borderColor: "border-zinc-800"
    borderCollapse: true
  
  header:
    background: "bg-zinc-900"
    textColor: "text-white"
    fontSize: "text-sm"
  
  body:
    alternateRows: false
    fontSize: "text-sm"
  
  cell:
    padding: "p-3"
    borderColor: "border-zinc-800"
  
  # Enhanced íŠ¹í™” ìŠ¤íƒ€ì¼
  featureBoxes:
    margin: "mt-2"
    padding: "p-2"
    borderRadius: "rounded"
    fontSize: "text-xs"

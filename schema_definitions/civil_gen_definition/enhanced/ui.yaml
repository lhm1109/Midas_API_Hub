# ============================================================================
# UI RULES - UI ë Œë”ë§ í†µí•© ê·œì¹™
# ============================================================================
# Builder/Table/HTML ë Œë”ë§ì„ ìœ„í•œ í†µí•© ê·œì¹™
# ê³µí†µ ê·œì¹™ì€ shared.yamlì—ì„œ ìƒì†
# ============================================================================

version: "1.0.0"
extends: "./shared.yaml"

# ============================================================================
# LAYOUT - ë ˆì´ì•„ì›ƒ ê³µí†µ ê·œì¹™
# ============================================================================
layout:
  # ì„¹ì…˜ í—¤ë” (x-ui.sectionId ê¸°ë°˜ - x-ui.group deprecated)
  sectionHeader:
    enabled: true
    icon: "ğŸ“‹"
    style:
      borderTop: "border-t-2 border-cyan-800/50"
      textColor: "text-cyan-400"
      fontSize: "text-sm"
      fontWeight: "font-semibold"
      padding: "pt-4 pb-2"
      firstSection:
        borderTop: false

  # í•„ë“œ ê·¸ë£¹í™”
  fieldGrouping:
    enabled: true
    groupBy: "x-ui.sectionId"  # ğŸ”¥ x-ui.group deprecated

  # ì¤‘ì²© ê°ì²´
  nestedObject:
    accordion: true
    checkbox: true
    style:
      border: "border-zinc-700"
      background: "bg-zinc-900/50"
      headerBackground: "bg-zinc-800/50"

# ============================================================================
# ENHANCED FEATURES - x-* ë§ˆì»¤ ì§€ì›
# ============================================================================
enhancedFeatures:
  xui:
    enabled: true
    features:
      label: true
      hint: true
      sectionId: true  # ğŸ”¥ group deprecated â†’ sectionId
      visibleWhen: true

  xenumByType:
    enabled: true
    dynamicUpdate: true

  xvalueConstraint:
    enabled: true
    display: "hint"
    icon: "ğŸ’¡"
    style:
      color: "text-amber-400"
      fontSize: "text-[10px]"

  xnodeCountByType:
    enabled: true
    display: "hint"
    validationTrigger: "onChange"

# ============================================================================
# RENDERING - ë Œë”ë§ ê³µí†µ ê·œì¹™
# ============================================================================
rendering:
  requiredIndicator:
    enabled: true
    symbol: "*"
    color: "text-red-400"

  description:
    enabled: true
    source: "x-ui.label"
    fallback: "key"
    position: "inline"
    style:
      color: "text-zinc-200"
      fontSize: "text-sm"

  typeIndicator:
    enabled: true
    position: "right"
    style:
      color: "text-zinc-600"
      fontSize: "text-[10px]"
      fontFamily: "font-mono"

  hintDisplay:
    enabled: true
    position: "below"
    sources:
      - "x-ui.hint"
      - "x-value-constraint"
      - "x-node-count-by-type"
    style:
      color: "text-amber-400"
      fontSize: "text-[10px]"
      fontStyle: "italic"
      icon: "ğŸ’¡"

# ============================================================================
# VALIDATION DISPLAY - ê²€ì¦ í‘œì‹œ
# ============================================================================
validation:
  standard:
    enabled: true
    badge: "STD"
    badgeColor: "bg-blue-900/50 text-blue-300 border-blue-700/50"

  appLayer:
    enabled: true
    badge: "APP"
    badgeColor: "bg-orange-900/50 text-orange-300 border-orange-700/50"

  errorDisplay:
    position: "below"
    style:
      color: "text-red-400"
      fontSize: "text-xs"
      icon: "âŒ"

  warningDisplay:
    position: "below"
    style:
      color: "text-yellow-400"
      fontSize: "text-xs"
      icon: "âš ï¸"

# ============================================================================
# BUILDER SPECIFIC - Builder íƒ­ ì „ìš©
# ============================================================================
builder:
  formLayout:
    container:
      className: "bg-gradient-to-br from-purple-950/50 to-zinc-900 border-2 border-purple-800/50 rounded-lg p-6"
    title:
      text: "Schema-Based Fields"
      icon: "ğŸ“"
    fieldContainer:
      className: "space-y-4"

  fieldRendering:
    standard:
      label:
        source: "description"
        fallback: "name"
        showRequired: true
        showType: true
      input:
        className: "bg-zinc-800 border-zinc-700"

    enum:
      component: "Select"
      dynamic: true
      triggerField: "TYPE"

    array:
      component: "Textarea"
      parseJson: true
      showHint: true

    object:
      accordion: true
      checkbox: true
      expandByDefault: false

  dynamicBehavior:
    conditionalVisibility:
      enabled: true
      autoDetect: true
      evaluateOn: "change"
      hideMode: "remove"

    dynamicEnum:
      enabled: true
      triggerField: "TYPE"
      preserveValue: false

    dynamicRequired:
      enabled: true
      triggerField: "TYPE"

  instanceManagement:
    enabled: true
    wrapper: "Assign"
    defaultInstance: "1"

  jsonPreview:
    enabled: true
    modes:
      - "annotated"
      - "monaco"
    defaultMode: "annotated"

# ============================================================================
# TABLE SPECIFIC - Table (Spec) íƒ­ ì „ìš©
# ============================================================================
table:
  # ìŠ¤í‚¤ë§ˆ í™•ì¥ í•„ë“œ ì¶”ì¶œ ê·œì¹™
  schemaExtensions:
    extractFromSchema:
      - { key: "x-ui", targetProperty: "ui", transformKey: true }
      - { key: "x-enum-labels", targetProperty: "enumLabels", transformKey: true }
      - { key: "x-enum-by-type", targetProperty: "enumByType", transformKey: true }
      - { key: "x-enum-labels-by-type", targetProperty: "enumLabelsByType", transformKey: true }
      - { key: "x-node-count-by-type", targetProperty: "nodeCountByType", transformKey: true }
      - { key: "x-value-constraint", targetProperty: "valueConstraint", transformKey: true }
      - { key: "x-required-by-type", targetProperty: "requiredByType", transformKey: true }
      - { key: "x-transport", targetProperty: "x-transport", passthrough: true }

  # í…Œì´ë¸” êµ¬ì¡°
  structure:
    columns:
      - { id: "no", header: "No.", width: "6%", align: "center" }
      - { id: "description", header: "Description", width: "35%", align: "left" }
      - { id: "key", header: "Key", width: "14%", align: "left" }
      - { id: "type", header: "Value Type", width: "10%", align: "center" }
      - { id: "default", header: "Default", width: "10%", align: "center" }
      - { id: "required", header: "Required", width: "25%", align: "left" }

    numbering:
      start: 1
      resetOnSection: false

  # í–‰ ë Œë”ë§
  rowRendering:
    description:
      source: "x-ui.label"
      fallback: "key"
      markdown: true
      features:
        enum:
          enabled: true
          title: "**Enum Values:**"
          format: "â€¢ {value} - {label}"
        enumByType:
          enabled: true
          title: "**Enum Values by Type:**"
        valueConstraint:
          enabled: true
          title: "**Value Constraints:**"
          badge: "APP"
        nodeCountByType:
          enabled: true
          title: "**Node Count by Type:**"
          badge: "APP"

    key:
      format: "\"{key}\""
      style:
        color: "text-blue-400"
        fontFamily: "font-mono"

    required:
      dynamicByType: true

  # ì¤‘ì²© í•„ë“œ
  nestedFields:
    enabled: true
    expandable: true
    expandIcon: "â–¼"
    collapseIcon: "â–¶"
    style:
      indentation: "pl-8"
      background: "bg-zinc-900/50"
      keyColor: "text-amber-400"

# ============================================================================
# STYLING - ì „ì—­ ìŠ¤íƒ€ì¼
# ============================================================================
styling:
  colors:
    primary: "blue-600"
    secondary: "cyan-600"
    success: "green-600"
    error: "red-600"
    warning: "amber-600"
    section: "cyan-400"

  spacing:
    fieldGap: "4"
    sectionGap: "6"

  borders:
    fieldBorder: "border-zinc-700"
    sectionBorder: "border-cyan-800/50"

# ============================================================================
# VALIDATION MESSAGES - ê²€ì¦ ë©”ì‹œì§€ í…œí”Œë¦¿
# ============================================================================
validationMessages:
  required: "{field} is required for {TYPE}"
  invalidType: "{field} must be a {type}"
  invalidEnum: "{field} must be one of: {values} (for {TYPE})"
  minItems: "{field} must have at least {min} items"
  maxItems: "{field} must have at most {max} items"
  nodeCount: "{field} must have {count} nodes for {TYPE}"
  valueConstraint: "{field}: {constraint}"

# ============================================================================
# FALLBACK UI - í´ë°± ë Œë”ë§ (missing x-ui ì²˜ë¦¬)
# ============================================================================
fallbackUI:
  # x-ui ì—†ëŠ” í•„ë“œ ì²˜ë¦¬
  missingXui:
    label:
      source: "key"
      transform: "humanize"  # "iTENDON_TYPE" â†’ "I Tendon Type"
    sectionId: "SECTION_GENERAL"  # ğŸ”¥ sectionRegistry.id ì°¸ì¡°
    component: "Input"
    warn: true

  # ì•Œ ìˆ˜ ì—†ëŠ” íƒ€ì… ì²˜ë¦¬
  unknownType:
    component: "Textarea"
    props:
      placeholder: "Enter value as JSON"
    warn: true

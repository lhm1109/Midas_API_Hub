# ============================================================================
# MCP RULES - MCP ì„œë²„ ì „ìš© ê·œì¹™
# ============================================================================
# MCP ì„œë²„ê°€ ì§€ì¼œì•¼ í•  ë³´ì•ˆ, IO, ê²°ì •ë¡ , ê²€ì¦ ê·œì¹™
# ìŠ¤í‚¤ë§ˆ ì˜ë¯¸ëŠ” shared.yamlì—ì„œ ì°¸ì¡°
# ============================================================================

version: "1.0.0"
extends: "./shared.yaml"

# ============================================================================
# ğŸ”¥ SCHEMA PHILOSOPHY (í•µì‹¬ ì›ì¹™)
# ============================================================================
# - ê²€ì¦ ë¡œì§: í‘œì¤€ JSON Schema í‚¤ì›Œë“œ (allOf, if/then, required, enum)
# - UI í‘œí˜„: x-* ë§ˆì»¤ (ì‚­ì œí•´ë„ ê²€ì¦ ë™ì‘ ë™ì¼)
# - AI ìŠ¤í‚¤ë§ˆ ìƒì„± ì‹œ ì´ ì›ì¹™ ì¤€ìˆ˜ í•„ìˆ˜!
# ============================================================================

# ============================================================================
# SECURITY - ë³´ì•ˆ ì •ì±…
# ============================================================================
security:
  # ì½ê¸° í—ˆìš© ê²½ë¡œ
  readAllowlist:
    - "schema_definitions/**/*.{yaml,yml}"
    - "schema_definitions/**/*.json"
  
  # ì“°ê¸° í—ˆìš© ê²½ë¡œ
  writeAllowlist:
    - "generated_schemas/**/*.json"
  
  # ì°¨ë‹¨ ì •ì±…
  deny:
    pathTraversal: true      # ../ ì°¨ë‹¨
    symlinks: true           # ì‹¬ë³¼ë¦­ ë§í¬ ì°¨ë‹¨
    absolutePaths: true      # ì ˆëŒ€ ê²½ë¡œ ì°¨ë‹¨ (allowlist ì™¸)

# ============================================================================
# DETERMINISM - ê²°ì •ë¡ ì  ì¶œë ¥ ë³´ì¥
# ============================================================================
determinism:
  # JSON ì¶œë ¥ ê·œì¹™
  json:
    sortObjectKeys: true     # í‚¤ ì•ŒíŒŒë²³ ì •ë ¬
    indent: 2
    lineEnding: "LF"         # CRLF | LF
  
  # ë°°ì—´ ì²˜ë¦¬
  array:
    preserveOrder: true      # ì›ë³¸ ìˆœì„œ ìœ ì§€
  
  # íƒ€ì… ê°•ì œ ë³€í™˜ ê¸ˆì§€
  forbidTypeCoercion: true   # "1" â†’ 1 ë³€í™˜ ê¸ˆì§€
  
  # YAML Alias ì²˜ë¦¬
  yamlAliasPolicy: "expand"  # expand | preserve | reject

# ============================================================================
# VALIDATION PIPELINE - ê²€ì¦ íŒŒì´í”„ë¼ì¸
# ============================================================================
validation:
  # Enum ê·œì¹™
  enum:
    integerMustUseOneOf: true
    autoConvert:
      enabled: true
      from: "enum"
      to: "oneOf"
      fallbackLabel: "Option {value}"
  
  # êµ¬ì¡° ê²€ì¦
  structure:
    requireSchema: 
      enabled: true
      value: "http://json-schema.org/draft-07/schema#"
    recommendTitle:
      enabled: true
      level: "warning"
    requiredFieldsExist:
      enabled: true
      message: "requiredì— ìˆëŠ” í•„ë“œê°€ propertiesì— ì—†ìŠµë‹ˆë‹¤"
  
  # íƒ€ì… ê²€ì¦
  type:
    prefixMatch:
      enabled: true
      # ê·œì¹™ì€ shared.yamlì˜ typeInferenceRegistry ì°¸ì¡°

# ============================================================================
# TRANSFORM RULES - ë³€í™˜ ê·œì¹™
# ============================================================================
transform:
  # ë£¨íŠ¸ ë˜í¼ í‚¤ ì œê±°
  unwrapRootKey:
    enabled: true
    extractTitle: true
    preserveMetadata:
      - "description"
      - "x-ui"
      - "x-transport"
  
  # Unknown key ì²˜ë¦¬
  unknownKeys:
    action: "passthrough"    # passthrough | remove | error
    collect: true            # metaì— ê¸°ë¡
    
  # x-* ë§ˆì»¤ ì²˜ë¦¬
  markers:
    # shared.yamlì˜ markerRegistry ì°¸ì¡°
    unknownMarker: "passthrough"  # passthrough | warn | error

# ============================================================================
# FIELD NAMING RULES - í•„ë“œ ë„¤ì´ë° ê·œì¹™ (AI ìŠ¤í‚¤ë§ˆ ìƒì„±ìš©)
# ============================================================================
# ğŸ“Œ AIê°€ ìŠ¤í‚¤ë§ˆ ìƒì„± ì‹œ ì´ ê·œì¹™ì„ ì°¸ì¡°í•˜ì—¬ ì¶•ì•½í˜• í‚¤ ì´ë¦„ì„ ì‚¬ìš©í•´ì•¼ í•¨
fieldNaming:
  # ğŸ”¥ ìŠ¤íƒ€ì¼ ê°€ì´ë“œ
  style:
    case: "UPPER_SNAKE"       # UPPER_SNAKE | camelCase | PascalCase
    maxLength: 12             # ìµœëŒ€ 12ì ê¶Œì¥
    abbreviateCommonWords: true
  
  # ğŸ”¥ ì ‘ë‘ì‚¬ ê·œì¹™ (íƒ€ì… ì¶”ë¡ )
  prefixes:
    i: "integer"              # iTENDON_TYPE, iCONSTR_TYPE
    s: "string"               # sDESIGN_CODE, sTYPE
    d: "number"               # dEXPOSURE_FACTOR, dANGLE
    b: "boolean"              # bUSE_LIMIT, bFLEX_CHECK
    n: "number"               # nVALUE (legacy)
    arr: "array"              # arrNODE, arrVALUES
  
  # ğŸ”¥ ì¶•ì•½ì–´ ì‚¬ì „ (AI ìƒì„± ì‹œ í™œìš©)
  abbreviations:
    # ê³µí†µ ì•½ì–´
    Construction: "CONSTR"
    Combination: "COMB"
    Combinations: "COMBS"
    Principal: "PRINC"
    Flexural: "FLEX"
    Strength: "STR"
    Service: "SVC"
    Factored: "FACT"
    Maximum: "MAX"
    Minimum: "MIN"
    Shear: "SHEAR"
    Torsion: "TORS"
    Combined: "COMB"
    Check: "CHK"
    Stress: "STRS"
    Prestressing: "PREST"
    Tendons: "TEND"
    Stage: "STG"
    Loads: "LD"
    Load: "LD"
    Value: "VAL"
    Factor: "FACT"
    Exposure: "EXP"
    Type: "TYPE"
    Class: "CLS"
    Code: "CODE"
    Design: "DES"
    Condition: "COND"
    Corrosive: "CORR"
    Relaxation: "RLX"
    Relieved: "RLV"
    Segmental: "SEG"
    Number: ""                # ìƒëµ (NODE = Node No.)
    
  # ğŸ”¥ ì˜ˆì‹œ ë§¤í•‘ (ê¸´ ì´ë¦„ â†’ ì¶•ì•½ ì´ë¦„)
  examples:
    # Output Parameters - Factored Loads
    - long: "bCombinedShearAndTorsionCheck"
      short: "bCOMB_SHEAR_TORS"
      label: "Combined Shear and Torsion Check"
      
    - long: "bFlexuralStrengthCheck"
      short: "bFLEX_STR_CHK"
      label: "Flexural Strength Check"
      
    - long: "bShearStrengthCheck"
      short: "bSHEAR_STR_CHK"
      label: "Shear Strength Check"
    
    # Output Parameters - Service Loads
    - long: "bStressByConstructionStage"
      short: "bSTRS_CONSTR"
      label: "Stress by Construction Stage"
      
    - long: "bStressByServiceLoadCombinations"
      short: "bSTRS_SVC_COMB"
      label: "Stress by Service Load Combinations"
      
    - long: "bStressInPrestressingTendons"
      short: "bSTRS_PREST"
      label: "Stress in Prestressing Tendons"
      
    - long: "bPrincipalStressByConstructionStage"
      short: "bPRINC_CONSTR"
      label: "Principal Stress by Construction Stage"
      
    - long: "bPrincipalStressByMaxShear"
      short: "bPRINC_MAX_SHEAR"
      label: "Principal Stress by Service Load (Max Shear)"
      
    - long: "bPrincipalStressByMaxTorsion"
      short: "bPRINC_MAX_TORS"
      label: "Principal Stress by Service Load (Max Torsion)"
    
    - long: "bCrackCheck"
      short: "bCRACK_CHK"
      label: "Crack Check"
    
    # Input Parameters
    - long: "iTendonType"
      short: "iTEND_TYPE"
      label: "Tendon Type"
      
    - long: "iCorrosiveCondition"
      short: "iCORR_COND"
      label: "Corrosive Condition"
      
    - long: "iFlexuralStrength"
      short: "iFLEX_STR"
      label: "Flexural Strength"
      
    - long: "iExposureFactor"
      short: "iEXP_FACT"
      label: "Exposure Factor for Crack Width"
      
    - long: "dExposureFactorValue"
      short: "dEXP_VAL"
      label: "User Exposure Factor Value"
      
    - long: "iConstructionType"
      short: "iCONSTR_TYPE"
      label: "Construction Type"
      
    - long: "sDesignCode"
      short: "sDES_CODE"
      label: "Design Code"

# ============================================================================
# OUTPUT - ì¶œë ¥ ê·œì¹™
# ============================================================================
output:
  # íŒŒì¼ëª… ê·œì¹™
  filename:
    case: "UPPER_SNAKE"      # ëŒ€ë¬¸ì ìŠ¤ë„¤ì´í¬ ì¼€ì´ìŠ¤
    extension: ".json"
  
  # ë©”íƒ€ë°ì´í„° í¬í•¨
  meta:
    enabled: true
    fields:
      - "rulesVersion"
      - "specVersion"
      - "sourceHash"
      - "outputHash"
      - "generatedAt"
      - "appliedRuleIds"
      - "warnings"
      - "unknownKeys"
  
  # ë³„ë„ meta.json íŒŒì¼ ìƒì„±
  separateMetaFile: false    # trueë©´ SCHEMA_NAME.meta.json ìƒì„±

# ============================================================================
# TOOL CONTRACT - MCP ë„êµ¬ ê³„ì•½
# ============================================================================
toolContract:
  # save_schema ë„êµ¬
  saveSchema:
    requiredParams:
      - schemaName
      - schema
    optionalParams:
      - description
      - outputDir
      - questions
      - skipValidation
    
    # ì§ˆë¬¸ í•„ë“œ ì •ì±…
    questions:
      maxItems: 10
      requiredFields:
        - field
        - question
      optionalFields:
        - context
        - suggestion

# ============================================================================
# AUTO-QUESTION PATTERNS - ìë™ ì§ˆë¬¸ íŒ¨í„´ (AI ì°¸ì¡°ìš©)
# ============================================================================
# ğŸ“Œ AIê°€ ìŠ¤í‚¤ë§ˆ ìƒì„± ì‹œ ì•„ë˜ íŒ¨í„´ì„ ê°ì§€í•˜ë©´ ì‚¬ìš©ìì—ê²Œ ì§ˆë¬¸í•´ì•¼ í•¨
autoQuestionPatterns:
  # ğŸ”¥ ì¡°ê±´ë¶€ ì…ë ¥ í•„ë“œ íŒ¨í„´
  conditionalInput:
    description: |
      ë¼ë””ì˜¤/ë“œë¡­ë‹¤ìš´ ì˜µì…˜ ì¤‘ "User", "Custom", "ì§ì ‘ ì…ë ¥" ë“±ì˜ ì˜µì…˜ì´ ìˆìœ¼ë©´
      í•´ë‹¹ ì˜µì…˜ ì„ íƒ ì‹œ í…ìŠ¤íŠ¸/ìˆ«ì ì…ë ¥ í•„ë“œê°€ í™œì„±í™”ë˜ëŠ”ì§€ ì§ˆë¬¸í•´ì•¼ í•¨
    triggers:
      - "User"
      - "Custom"
      - "Manual"
      - "ì§ì ‘ ì…ë ¥"
      - "ì‚¬ìš©ì ì •ì˜"
    question: |
      "{option}" ì˜µì…˜ì„ ì„ íƒí•˜ë©´ ë³„ë„ì˜ ì…ë ¥ í•„ë“œê°€ í™œì„±í™”ë˜ë‚˜ìš”?
      (ì˜ˆ: ìˆ«ì ì…ë ¥, í…ìŠ¤íŠ¸ ì…ë ¥)
    # ğŸ”¥ NEW: í‘œì¤€ JSON Schema ë°©ì‹ (ê²€ì¦ ë¡œì§)
    schemaPattern: |
      allOf:
        - if:
            properties:
              {parentField}:
                const: {optionValue}
          then:
            required:
              - {inputField}
    # ğŸ”¥ ì¡°ê±´ë¶€ í‘œì‹œ (x-optional-when ì‚¬ìš©)
    optionalWhenPattern: |
      x-optional-when:
        {parentField}: {optionValue}
  
  # ğŸ”¥ TYPEë³„ ì¡°ê±´ë¶€ í•„ë“œ íŒ¨í„´
  typeConditionalFields:
    description: |
      TYPE ì„ íƒì— ë”°ë¼ ë³´ì´ëŠ”/ìˆ¨ê²¨ì§€ëŠ” í•„ë“œê°€ ìˆëŠ”ì§€ í™•ì¸
    question: |
      "{field}" í•„ë“œëŠ” íŠ¹ì • TYPEì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥í•œê°€ìš”?
      ì–´ë–¤ TYPEì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œì§€ ì•Œë ¤ì£¼ì„¸ìš”.
    # ğŸ”¥ NEW: í‘œì¤€ JSON Schema ë°©ì‹ (ê²€ì¦ ë¡œì§)
    schemaPattern: |
      allOf:
        - if:
            properties:
              TYPE:
                const: "TYPE1"
          then:
            required:
              - {field}
            properties:
              {field}:
                enum: [...]
    # ğŸ”¥ ì¡°ê±´ë¶€ í‘œì‹œ + ë¼ë²¨ (x-optional-when ì‚¬ìš©)
    optionalWhenPattern: |
      x-optional-when:
        TYPE: "TYPE1"
      x-enum-labels-by-type:
        TYPE1:
          "1": "Option A"
          "2": "Option B"
  
  # ğŸ”¥ ê·¸ë£¹/ì„¹ì…˜ í† ê¸€ íŒ¨í„´
  groupToggle:
    description: |
      íŠ¹ì • ì˜µì…˜ ì„ íƒ ì‹œ ì „ì²´ ê·¸ë£¹/ì„¹ì…˜ì´ í™œì„±í™”ë˜ëŠ” ê²½ìš°
    triggers:
      - "Enable"
      - "Use"
      - "í™œì„±í™”"
      - "ì‚¬ìš©"
    question: |
      "{option}" ì˜µì…˜ì„ ì„ íƒí•˜ë©´ ì¶”ê°€ ì„¤ì • ì˜ì—­ì´ í™œì„±í™”ë˜ë‚˜ìš”?
      ì–´ë–¤ í•„ë“œë“¤ì´ í™œì„±í™”ë˜ëŠ”ì§€ ì•Œë ¤ì£¼ì„¸ìš”.
  
  # ğŸ”¥ ê¸°ë³¸ê°’ ì—°ë™ íŒ¨í„´
  linkedDefaults:
    description: |
      í•œ í•„ë“œì˜ ì„ íƒì´ ë‹¤ë¥¸ í•„ë“œì˜ ê¸°ë³¸ê°’ì— ì˜í–¥ì„ ì£¼ëŠ” ê²½ìš°
    question: |
      "{field1}" ì„ íƒì— ë”°ë¼ "{field2}"ì˜ ê¸°ë³¸ê°’ì´ ë³€ê²½ë˜ë‚˜ìš”?
      
  # ğŸ”¥ Select All / Unselect All íŒ¨í„´
  bulkSelection:
    description: |
      "Select All", "Unselect All" ë²„íŠ¼ì´ ìˆëŠ” ì²´í¬ë°•ìŠ¤ ê·¸ë£¹
    triggers:
      - "Select All"
      - "Unselect All"
      - "ëª¨ë‘ ì„ íƒ"
      - "ëª¨ë‘ í•´ì œ"
    question: |
      ì´ ì²´í¬ë°•ìŠ¤ ê·¸ë£¹ì— "ëª¨ë‘ ì„ íƒ/í•´ì œ" ê¸°ëŠ¥ì´ í•„ìš”í•œê°€ìš”?
    note: |
      ì´ ê¸°ëŠ¥ì€ ìŠ¤í‚¤ë§ˆê°€ ì•„ë‹Œ UI ë Œë”ëŸ¬ì—ì„œ ì²˜ë¦¬ë¨

# ============================================================================
# EXAMPLE QUESTIONS - ì§ˆë¬¸ ì˜ˆì‹œ (AI ì°¸ì¡°ìš©)
# ============================================================================
exampleQuestions:
  - field: "iEXP_FACT"
    question: |
      "Exposure Factor for Crack Width"ì—ì„œ "User" ì˜µì…˜ì„ ì„ íƒí•˜ë©´ 
      ë³„ë„ì˜ ìˆ«ì ì…ë ¥ í•„ë“œê°€ í™œì„±í™”ë˜ë‚˜ìš”? ìˆë‹¤ë©´ ê¸°ë³¸ê°’ì€ ë¬´ì—‡ì¸ê°€ìš”?
    context: "ì´ë¯¸ì§€ì—ì„œ 'User' ì˜µì…˜ ì˜†ì— ì…ë ¥ í•„ë“œê°€ ë³´ì…ë‹ˆë‹¤"
    # ğŸ”¥ NEW: í‘œì¤€ JSON Schema ë°©ì‹ ê¶Œì¥
    suggestion:
      addField: "dEXP_VAL"
      type: "number"
      default: 1
      # ê²€ì¦ ë¡œì§ (allOf if/then)
      allOfPattern: |
        allOf:
          - if:
              properties:
                iEXP_FACT:
                  const: 2
            then:
              required:
                - dEXP_VAL
      # ì¡°ê±´ë¶€ í‘œì‹œ (x-optional-when ì‚¬ìš©)
      optionalWhenPattern: |
        x-optional-when:
          iEXP_FACT: 2
        
  - field: "STYPE"
    question: |
      \"Element Subtype\"ì€ ëª¨ë“  TYPEì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œê°€ìš”?
      ì•„ë‹ˆë©´ íŠ¹ì • TYPEì—ì„œë§Œ ë³´ì´ë‚˜ìš”?
    context: "allOf if/thenìœ¼ë¡œ ì¡°ê±´ë¶€ enum ì •ì˜ í•„ìš”"
    # ğŸ”¥ NEW: í‘œì¤€ JSON Schema ë°©ì‹ ê¶Œì¥
    suggestion:
      usePattern: "allOf if/then + x-enum-labels-by-type"
      example: |
        allOf:
          - if:
              properties:
                TYPE:
                  const: "TENSTR"
            then:
              properties:
                STYPE:
                  enum: [1, 2, 3]
        # UI ë¼ë²¨ (ê²€ì¦ê³¼ ë¬´ê´€)
        x-enum-labels-by-type:
          TENSTR:
            "1": "Truss Type"
            "2": "Hook Type"
            "3": "Cable Type"

# ============================================================================
# ğŸ”¥ AI PROMPTS - MCP í”„ë¡¬í”„íŠ¸ ê·œì¹™ (SSOT)
# ============================================================================
# AIê°€ prompts/getì„ í˜¸ì¶œí•˜ë©´ ì´ ì„¹ì…˜ì˜ ë‚´ìš©ì´ ë°˜í™˜ë¨
# ëª¨ë“  ìŠ¤í‚¤ë§ˆ ìƒì„± ê·œì¹™ì€ ì—¬ê¸°ì— ì •ì˜ (TypeScriptì— ì¤‘ë³µ ê¸ˆì§€)
# ============================================================================
aiPrompts:
  schema_rules:
    name: "schema_rules"
    description: "ìŠ¤í‚¤ë§ˆ ìƒì„± ì‹œ ë”°ë¼ì•¼ í•  ê·œì¹™ ì¡°íšŒ"
    
    # ì„¹ì…˜ë³„ ê·œì¹™ ì •ì˜
    sections:
      conditional: |
        ã€ì¡°ê±´ë¶€ í•„ë“œ ë§ˆì»¤ ê·œì¹™ã€‘
        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        
        âœ… í—ˆìš©ëœ ë§ˆì»¤:
          â€¢ x-required-when: ì¡°ê±´ ë§Œì¡± ì‹œ í•„ìˆ˜ + í‘œì‹œ
          â€¢ x-optional-when: ì¡°ê±´ ë§Œì¡± ì‹œ ì„ íƒ + í‘œì‹œ
        
        âŒ ê¸ˆì§€ëœ íŒ¨í„´ (ìë™ ë³€í™˜ë¨):
          â€¢ x-uiRules.visibleWhen â†’ x-optional-when
          â€¢ x-ui.visibleWhen â†’ x-optional-when
        
        ğŸ“‹ ê°ì²´ í˜•ì‹ (ë‹¨ì¼ ì¡°ê±´):
          "WALL_ID": {
            "x-optional-when": { "TYPE": "WALL" }
          }
        
        ğŸ“‹ ë³µí•© ì¡°ê±´ (AND):
          "CABLE": {
            "x-optional-when": { "TYPE": "TENSTR", "STYPE": 3 }
          }
        
        ğŸ“‹ ğŸ”¥ ë°°ì—´ í˜•ì‹ (ì—¬ëŸ¬ ì¡°ê±´ + íŒíŠ¸):
          "TENS": {
            "x-optional-when": [
              { 
                "condition": { "TYPE": "TENSTR" }, 
                "hint": "ìŒìˆ˜ ì…ë ¥ ê¶Œì¥ (allowable compression)" 
              },
              { 
                "condition": { "TYPE": "COMPTR" }, 
                "hint": "ì–‘ìˆ˜ ì…ë ¥ ê¶Œì¥ (allowable tension)" 
              }
            ]
          }
        
        ğŸ”¥ ë°°ì—´ í˜•ì‹ ì¥ì :
          â€¢ ì¡°ê±´ë³„ íŒíŠ¸ë¥¼ ì§ì ‘ í¬í•¨ ê°€ëŠ¥
          â€¢ ì¡°ê±´ë³„ ë‹¤ë¥¸ ê·¸ë£¹IDë„ ì„¤ì • ê°€ëŠ¥
          â€¢ ê°™ì€ í•„ë“œê°€ ì—¬ëŸ¬ ì¡°ê±´ì—ì„œ ë‹¤ë¥´ê²Œ í‘œì‹œ

      ui: |
        ã€UI ë§ˆì»¤ ê·œì¹™ã€‘
        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        
        x-ui ê°ì²´ êµ¬ì¡°:
          {
            "label": "í•„ë“œ ë¼ë²¨",          // í•„ìˆ˜
            "groupId": "ê·¸ë£¹ ID",          // ì„ íƒ
            "order": 10,                   // ì„ íƒ
            "placeholder": "íŒíŠ¸ í…ìŠ¤íŠ¸"   // ì„ íƒ
          }
        
        âš ï¸ x-ui ë‚´ì— visibleWhen ì‚¬ìš© ê¸ˆì§€!
           â†’ ëŒ€ì‹  x-optional-when ë˜ëŠ” x-required-when ì‚¬ìš©
        
        x-ui ì™¸ë¶€ ë§ˆì»¤:
          â€¢ x-enum-labels: enum ê°’ ë¼ë²¨
          â€¢ x-enum-labels-by-type: TYPEë³„ enum ë¼ë²¨

      validation: |
        ã€ê²€ì¦ ë¡œì§ ê·œì¹™ã€‘
        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        
        í•µì‹¬ ì›ì¹™: ê²€ì¦ ë¡œì§ì€ í‘œì¤€ JSON Schema í‚¤ì›Œë“œ ì‚¬ìš©
        
        ì¡°ê±´ë¶€ í•„ìˆ˜ í•„ë“œ (allOf if/then):
          "allOf": [
            {
              "if": { "properties": { "TYPE": { "const": "WALL" } } },
              "then": { "required": ["WALL_ID", "W_CON"] }
            }
          ]
        
        ì •ìˆ˜ enum â†’ oneOf ë³€í™˜ (ìë™):
          âŒ "enum": [1, 2, 3]
          âœ… "oneOf": [
               { "const": 1, "title": "Option A" },
               { "const": 2, "title": "Option B" }
             ]

      questions: |
        ã€ì§ˆë¬¸(questions) ê·œì¹™ã€‘
        â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
        
        ë‹¤ìŒ ìƒí™©ì—ì„œëŠ” ë°˜ë“œì‹œ questions ë°°ì—´ì— ì§ˆë¬¸ ì¶”ê°€:
        
        1. í•„ë“œ íƒ€ì…/enum ê°’ì´ ë¶ˆí™•ì‹¤í•œ ê²½ìš°
        2. ì¡°ê±´ë¶€ ë¡œì§ì´ ë³µì¡í•˜ê±°ë‚˜ ë¶ˆëª…í™•í•œ ê²½ìš°
        3. ê¸°ë³¸ê°’ì´ í™•ì‹¤í•˜ì§€ ì•Šì€ ê²½ìš°
        4. í•„ë“œ ê°„ ê´€ê³„ê°€ ì´ë¯¸ì§€ì—ì„œ ëª…í™•í•˜ì§€ ì•Šì€ ê²½ìš°
        
        ì§ˆë¬¸ í˜•ì‹:
          {
            "field": "í•„ë“œëª…",
            "question": "ì§ˆë¬¸ ë‚´ìš©",
            "context": "ìƒí™© ì„¤ëª… (ì„ íƒ)",
            "suggestion": { "type": "integer", "default": 0 }
          }

# 📘 YAML 기반 스키마 정의 완전 가이드

> 코딩 경험이 없어도 쉽게 배울 수 있는 단계별 매뉴얼

---

## 📑 목차

1. [서론: YAML이란 무엇인가?](#1-서론-yaml이란-무엇인가)
2. [기본 이론: YAML의 기초](#2-기본-이론-yaml의-기초)
3. [실전: 스키마 정의 작성하기](#3-실전-스키마-정의-작성하기)
4. [심화: 시스템 동작 원리](#4-심화-시스템-동작-원리)
5. [참고 자료](#5-참고-자료)

---

## 1. 서론: YAML이란 무엇인가?

### 1.1 왜 YAML을 사용하나요?

YAML은 **"사람이 읽기 쉬운 데이터 형식"**입니다. 프로그래밍 코드를 수정하지 않고도 시스템의 동작 규칙을 변경할 수 있습니다.

```
┌─────────────────────────────────────────────────────────────┐
│                                                                 │
│  기존 방식 (코드 수정)                                           │
│  ━━━━━━━━━━━━━━━━━━                                            │
│                                                                 │
│  규칙 변경 필요                                                  │
│       ↓                                                         │
│  코드 파일 열기                                                  │
│       ↓                                                         │
│  프로그래밍 언어로 수정 (어려움!)                                 │
│       ↓                                                         │
│  컴파일/빌드                                                     │
│       ↓                                                         │
│  배포                                                            │
│                                                                 │
│  ❌ 시간이 오래 걸림                                             │
│  ❌ 프로그래밍 지식 필요                                          │
│  ❌ 실수 시 시스템 오류 발생 가능                                 │
│                                                                 │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│                                                                 │
│  새로운 방식 (YAML 수정)                                         │
│  ━━━━━━━━━━━━━━━━━━━                                           │
│                                                                 │
│  규칙 변경 필요                                                  │
│       ↓                                                         │
│  YAML 파일 열기                                                  │
│       ↓                                                         │
│  사람이 읽기 쉬운 형식으로 수정                                   │
│       ↓                                                         │
│  저장 → 즉시 반영!                                               │
│                                                                 │
│  ✅ 빠르고 간단함                                                │
│  ✅ 프로그래밍 지식 불필요                                        │
│  ✅ 안전하게 수정 가능                                            │
│                                                                 │
└─────────────────────────────────────────────────────────────┘
```

### 1.2 이 시스템에서 YAML의 역할

우리 시스템에서 YAML은 **"설정 파일"**입니다. 마치 설정 메뉴처럼, YAML 파일을 수정하면 시스템의 동작이 바뀝니다.

```
┌──────────────────────────────────────────────────────────────┐
│                     시스템 구조도                              │
└──────────────────────────────────────────────────────────────┘

    ┌─────────────────────────────────────────┐
    │      schema-logic.yaml                   │
    │      ═══════════════════                 │
    │                                           │
    │  📋 규칙 정의                             │
    │  • 섹션 이름은?                           │
    │  • 필드 순서는?                           │
    │  • 어떤 조건일 때 표시?                    │
    │  • 어떻게 검증?                           │
    │                                           │
    └─────────────────┬───────────────────────┘
                      │
                      │ (로드)
                      ↓
    ┌─────────────────────────────────────────┐
    │      schemaLogicEngine.ts                │
    │      ═══════════════════════              │
    │                                           │
    │  ⚙️ YAML을 읽어서 실행                    │
    │  • 파일 로드                              │
    │  • 규칙 해석                              │
    │  • 조건 평가                              │
    │                                           │
    └─────────────────┬───────────────────────┘
                      │
                      │ (사용)
                      ↓
    ┌─────────────────────────────────────────┐
    │      UI 화면                              │
    │      ═══════                              │
    │                                           │
    │  🖥️ 사용자가 보는 화면                     │
    │  • 폼 입력                                │
    │  • 테이블 표시                            │
    │  • 버튼/메뉴                              │
    │                                           │
    └─────────────────────────────────────────┘
```

---

## 2. 기본 이론: YAML의 기초

### 2.1 YAML의 기본 문법

YAML은 **들여쓰기**로 구조를 표현합니다. (탭이 아닌 **스페이스 2칸** 사용!)

#### 2.1.1 키-값 쌍 (Key-Value Pair)

가장 기본적인 형태입니다:

```yaml
이름: 홍길동
나이: 30
직업: 개발자
```

```
┌──────────────────────────────────┐
│  키    :  값                      │
│  ━━━      ━━                     │
│  이름  :  홍길동                  │
│  나이  :  30                      │
│  직업  :  개발자                  │
└──────────────────────────────────┘
```

#### 2.1.2 리스트 (List)

여러 개의 항목을 나열할 때:

```yaml
과일:
  - 사과
  - 바나나
  - 오렌지
```

```
┌──────────────────────────────────┐
│  과일:                            │
│    ├─ 사과                       │
│    ├─ 바나나                     │
│    └─ 오렌지                     │
└──────────────────────────────────┘
```

#### 2.1.3 중첩 구조 (Nested Structure)

구조를 계층적으로 표현:

```yaml
회사:
  이름: ABC 주식회사
  위치:
    국가: 대한민국
    도시: 서울
  직원수: 100
```

```
┌─────────────────────────────────────────┐
│  회사                                    │
│  ├─ 이름: ABC 주식회사                  │
│  ├─ 위치                                │
│  │   ├─ 국가: 대한민국                  │
│  │   └─ 도시: 서울                      │
│  └─ 직원수: 100                         │
└─────────────────────────────────────────┘
```

### 2.2 주의사항 ⚠️

```yaml
# ✅ 올바른 예시
이름: 홍길동
나이: 30

# ❌ 잘못된 예시 (콜론 뒤 공백 없음)
이름:홍길동
나이:30

# ❌ 잘못된 예시 (탭 사용)
	이름: 홍길동    # 탭 대신 스페이스 2칸!
```

```
┌────────────────────────────────────────────────┐
│  YAML 작성 체크리스트                           │
│  ═══════════════════════                        │
│                                                 │
│  ✓ 콜론(:) 뒤에 반드시 공백 한 칸              │
│  ✓ 들여쓰기는 스페이스 2칸 (탭 X)              │
│  ✓ 리스트는 하이픈(-) 사용                     │
│  ✓ 주석은 샵(#)으로 시작                       │
│  ✓ 문자열에 특수문자 있으면 따옴표("")         │
│                                                 │
└────────────────────────────────────────────────┘
```

---

## 3. 실전: 스키마 정의 작성하기

### 3.1 schema-logic.yaml 구조

```yaml
# ════════════════════════════════════════════════════════════
# schema-logic.yaml 구조 요약
# ════════════════════════════════════════════════════════════

sectionRules:        # 섹션을 어떻게 나눌지 정의
  - 규칙1
  - 규칙2
  
sectionOrder:        # 섹션 표시 순서
  - 섹션A
  - 섹션B
  
typeLabels:          # 타입 이름 표시 방법
  TYPE_A: "타입 A"
  TYPE_B: "타입 B"
  
validationLayerRules: # 검증 규칙
  STD: ...
  APP: ...
```

```
┌──────────────────────────────────────────────────────────┐
│                                                           │
│           schema-logic.yaml 구성 요소                     │
│           ═══════════════════════════                     │
│                                                           │
│   ┌─────────────────────────────────────────────┐       │
│   │  sectionRules (섹션 규칙)                    │       │
│   │  ━━━━━━━━━━━━━━━━━━━━                       │       │
│   │  언제 어떤 섹션으로 분류할지 결정            │       │
│   └─────────────────────────────────────────────┘       │
│                       ↓                                   │
│   ┌─────────────────────────────────────────────┐       │
│   │  sectionOrder (섹션 순서)                    │       │
│   │  ━━━━━━━━━━━━━━━━━━━                        │       │
│   │  화면에 표시되는 순서 지정                   │       │
│   └─────────────────────────────────────────────┘       │
│                       ↓                                   │
│   ┌─────────────────────────────────────────────┐       │
│   │  typeLabels (타입 레이블)                    │       │
│   │  ━━━━━━━━━━━━━━━━━━━                        │       │
│   │  코드 이름을 사람이 읽기 쉬운 이름으로       │       │
│   └─────────────────────────────────────────────┘       │
│                       ↓                                   │
│   ┌─────────────────────────────────────────────┐       │
│   │  validationLayerRules (검증 규칙)            │       │
│   │  ━━━━━━━━━━━━━━━━━━━━━━━━━                 │       │
│   │  입력값이 올바른지 확인하는 방법             │       │
│   └─────────────────────────────────────────────┘       │
│                                                           │
└──────────────────────────────────────────────────────────┘
```

### 3.2 섹션 규칙 작성하기

섹션 규칙은 **"이런 조건이면 이 섹션에 넣어라"**는 뜻입니다.

#### 예제 1: 명시적 그룹 사용

```yaml
sectionRules:
  - name: "Explicit Group"
    description: "x-ui.group이 명시되어 있으면 그대로 사용"
    condition:
      type: "has-explicit-group"
    action:
      type: "use-explicit-group"
```

```
┌─────────────────────────────────────────────────────────┐
│  동작 원리:                                              │
│                                                          │
│  입력 스키마:                                            │
│  ┌──────────────────────────────────┐                  │
│  │  FIELD_A:                         │                  │
│  │    x-ui:                          │                  │
│  │      group: "내가 지정한 섹션"     │                  │
│  └──────────────────────────────────┘                  │
│                ↓                                         │
│  [조건 확인: has-explicit-group]                         │
│                ↓                                         │
│  [액션 실행: use-explicit-group]                         │
│                ↓                                         │
│  결과:                                                   │
│  ┌──────────────────────────────────┐                  │
│  │  📦 내가 지정한 섹션               │                  │
│  │     └─ FIELD_A                   │                  │
│  └──────────────────────────────────┘                  │
└─────────────────────────────────────────────────────────┘
```

#### 예제 2: 타입 조건

```yaml
sectionRules:
  - name: "Tension and Compression"
    description: "TENSTR과 COMPTR 둘 다 포함"
    condition:
      type: "visible-types-include-all"
      types: ["TENSTR", "COMPTR"]
    action:
      type: "assign-section"
      section: "Tension/Compression"
```

```
┌─────────────────────────────────────────────────────────┐
│  동작 원리:                                              │
│                                                          │
│  입력 스키마:                                            │
│  ┌──────────────────────────────────┐                  │
│  │  FIELD_B:                         │                  │
│  │    x-ui:                          │                  │
│  │      visibleWhen:                 │                  │
│  │        TYPE: ["TENSTR", "COMPTR"] │                  │
│  └──────────────────────────────────┘                  │
│                ↓                                         │
│  [조건 확인: visible-types-include-all]                  │
│   → TENSTR 포함? ✓                                       │
│   → COMPTR 포함? ✓                                       │
│                ↓                                         │
│  [액션 실행: assign-section]                             │
│                ↓                                         │
│  결과:                                                   │
│  ┌──────────────────────────────────┐                  │
│  │  📦 Tension/Compression           │                  │
│  │     └─ FIELD_B                   │                  │
│  └──────────────────────────────────┘                  │
└─────────────────────────────────────────────────────────┘
```

### 3.3 섹션 순서 정의하기

화면에 표시되는 순서를 지정합니다:

```yaml
sectionOrder:
  - "Common Keys and Solid"
  - "Tension only"
  - "Compression only"
  - "Tension/Compression"
  - "Wall"
  - "Plate"
```

```
┌──────────────────────────────────────────────────┐
│  화면 표시 예시                                   │
│  ══════════════                                   │
│                                                   │
│  📦 Common Keys and Solid     ← 1순위            │
│     └─ TYPE                                      │
│     └─ MATL                                      │
│                                                   │
│  📦 Tension only              ← 2순위            │
│     └─ STYPE                                     │
│                                                   │
│  📦 Compression only          ← 3순위            │
│     └─ C_TYPE                                    │
│                                                   │
│  📦 Tension/Compression       ← 4순위            │
│     └─ TENS                                      │
│                                                   │
│  📦 Wall                      ← 5순위            │
│     └─ WALL                                      │
│                                                   │
│  📦 Plate                     ← 6순위            │
│     └─ PLATE_TYPE                                │
│                                                   │
└──────────────────────────────────────────────────┘
```

### 3.4 타입 레이블 정의하기

코드 이름을 사람이 읽기 쉬운 이름으로 바꿉니다:

```yaml
typeLabels:
  TENSTR: "Tension only"
  COMPTR: "Compression only"
  BEAM: "Beam"
  TRUSS: "Truss"
  PLATE: "Plate"
  WALL: "Wall"
```

```
┌────────────────────────────────────────────────────┐
│  변환 예시                                          │
│  ═══════════                                        │
│                                                     │
│  코드:    TENSTR                                    │
│            ↓                                        │
│  화면:    Tension only                              │
│                                                     │
│  코드:    COMPTR                                    │
│            ↓                                        │
│  화면:    Compression only                          │
│                                                     │
│  코드:    BEAM                                      │
│            ↓                                        │
│  화면:    Beam                                      │
│                                                     │
└────────────────────────────────────────────────────┘
```

### 3.5 검증 규칙 정의하기

어떤 필드를 어떻게 검증할지 정의합니다:

```yaml
validationLayerRules:
  STD:
    description: "Standard JSON Schema validation"
    triggers:
      - has-enum
      - has-minItems
      - has-maxItems
      - has-type
  
  APP:
    description: "Application-specific validation"
    triggers:
      - has-enumByType
      - has-nodeCountByType
      - has-valueConstraint
```

```
┌─────────────────────────────────────────────────────────┐
│  검증 레이어 동작 원리                                   │
│  ═══════════════════════                                 │
│                                                          │
│  필드 입력                                               │
│     ↓                                                    │
│  ┌──────────────────────────────────┐                  │
│  │  STD 레이어 (표준 검증)           │                  │
│  │  ━━━━━━━━━━━━━━━━━━━             │                  │
│  │  • enum에 있는 값인가?            │                  │
│  │  • 최소/최대 항목 수는?           │                  │
│  │  • 타입이 맞는가?                 │                  │
│  └──────────────────────────────────┘                  │
│     ↓ (통과)                                             │
│  ┌──────────────────────────────────┐                  │
│  │  APP 레이어 (애플리케이션 검증)   │                  │
│  │  ━━━━━━━━━━━━━━━━━━━━━━         │                  │
│  │  • TYPE별 enum이 맞는가?          │                  │
│  │  • 노드 개수가 맞는가?            │                  │
│  │  • 값 제약 조건을 만족하는가?     │                  │
│  └──────────────────────────────────┘                  │
│     ↓ (통과)                                             │
│  ✅ 입력 완료                                            │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

---

## 4. 심화: 시스템 동작 원리

### 4.1 전체 흐름도

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                      │
│                     🔄 시스템 전체 동작 흐름                          │
│                     ═══════════════════════                          │
│                                                                      │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │  1단계: 앱 시작                                               │  │
│  │  ━━━━━━━━━━━━━                                                │  │
│  │                                                                │  │
│  │  App.tsx 실행                                                  │  │
│  │     ↓                                                          │  │
│  │  useEffect() 트리거                                            │  │
│  │     ↓                                                          │  │
│  │  initSchemaLogicRules() 호출                                   │  │
│  └──────────────────────────────────────────────────────────────┘  │
│                           ↓                                         │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │  2단계: YAML 로딩                                             │  │
│  │  ━━━━━━━━━━━━━━                                               │  │
│  │                                                                │  │
│  │  schemaLogicEngine.ts                                          │  │
│  │     ↓                                                          │  │
│  │  fetch('/schema_definitions/enhanced/schema-logic.yaml')       │  │
│  │     ↓                                                          │  │
│  │  YAML 파일 읽기                                                │  │
│  │     ↓                                                          │  │
│  │  YAML 파싱 (텍스트 → 객체)                                    │  │
│  │     ↓                                                          │  │
│  │  cachedRules에 저장 (메모리 캐시)                             │  │
│  └──────────────────────────────────────────────────────────────┘  │
│                           ↓                                         │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │  3단계: 스키마 컴파일                                          │  │
│  │  ━━━━━━━━━━━━━━━━                                             │  │
│  │                                                                │  │
│  │  사용자가 API 선택                                              │  │
│  │     ↓                                                          │  │
│  │  enhancedSchemaCompiler.ts                                     │  │
│  │     ↓                                                          │  │
│  │  compileEnhancedSchema() 실행                                  │  │
│  │     │                                                          │  │
│  │     ├─ extractFields(): 필드 추출                             │  │
│  │     │                                                          │  │
│  │     ├─ determineSectionName(): 섹션 결정                      │  │
│  │     │   (YAML 규칙 사용!)                                      │  │
│  │     │                                                          │  │
│  │     ├─ sortSections(): 섹션 정렬                              │  │
│  │     │   (YAML 순서 사용!)                                      │  │
│  │     │                                                          │  │
│  │     └─ determineValidationLayers(): 검증 레이어 결정          │  │
│  │         (YAML 규칙 사용!)                                      │  │
│  └──────────────────────────────────────────────────────────────┘  │
│                           ↓                                         │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │  4단계: UI 렌더링                                              │  │
│  │  ━━━━━━━━━━━━━                                                │  │
│  │                                                                │  │
│  │  BuilderTab / SpecTab                                          │  │
│  │     ↓                                                          │  │
│  │  컴파일된 스키마를 화면에 표시                                  │  │
│  │     │                                                          │  │
│  │     ├─ 섹션별로 그룹화된 필드                                  │  │
│  │     ├─ 정해진 순서대로 표시                                    │  │
│  │     └─ 사람이 읽기 쉬운 레이블                                 │  │
│  └──────────────────────────────────────────────────────────────┘  │
│                           ↓                                         │
│  ┌──────────────────────────────────────────────────────────────┐  │
│  │  5단계: 사용자 입력 & 검증                                     │  │
│  │  ━━━━━━━━━━━━━━━━━━━━                                        │  │
│  │                                                                │  │
│  │  사용자가 값 입력                                               │  │
│  │     ↓                                                          │  │
│  │  determineValidationLayers() 확인                              │  │
│  │     ↓                                                          │  │
│  │  STD 레이어 검증                                                │  │
│  │     ↓                                                          │  │
│  │  APP 레이어 검증                                                │  │
│  │     ↓                                                          │  │
│  │  ✅ 모든 검증 통과                                              │  │
│  │     ↓                                                          │  │
│  │  API 요청 전송                                                  │  │
│  └──────────────────────────────────────────────────────────────┘  │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

### 4.2 섹션 결정 알고리즘

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                  │
│  determineSectionName() 동작 원리                                │
│  ═══════════════════════════════                                 │
│                                                                  │
│  입력: 필드 정보                                                  │
│     ↓                                                            │
│  ┌────────────────────────────────────────────┐                │
│  │  for (rule of sectionRules) {              │                │
│  │    ↓                                        │                │
│  │    조건 평가                                │                │
│  │    ↓                                        │                │
│  │    if (조건 만족) {                         │                │
│  │      ↓                                      │                │
│  │      액션 실행                              │                │
│  │      ↓                                      │                │
│  │      섹션 이름 반환                         │                │
│  │      ↓                                      │                │
│  │      return                                 │                │
│  │    }                                        │                │
│  │    ↓                                        │                │
│  │    (조건 불만족)                            │                │
│  │    ↓                                        │                │
│  │    다음 규칙으로                            │                │
│  │  }                                          │                │
│  └────────────────────────────────────────────┘                │
│     ↓                                                            │
│  모든 규칙 확인했지만 매칭 없음                                   │
│     ↓                                                            │
│  "Advanced" 반환 (기본값)                                        │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘

예시:

  필드: TENS
  x-ui:
    visibleWhen:
      TYPE: ["TENSTR", "COMPTR"]
  
  ↓ 규칙 1 확인: has-explicit-group?
     → NO (x-ui.group 없음)
  
  ↓ 규칙 2 확인: no-visible-when?
     → NO (visibleWhen 있음)
  
  ↓ 규칙 3 확인: visible-types-include-all ["TENSTR", "COMPTR"]?
     → YES! ✓
  
  ↓ 액션 실행: assign-section "Tension/Compression"
  
  결과: "Tension/Compression"
```

### 4.3 캐싱 메커니즘

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                  │
│  YAML 캐싱 메커니즘                                              │
│  ═══════════════════                                             │
│                                                                  │
│  첫 번째 호출:                                                    │
│  ┌────────────────────────────────────────────────────┐        │
│  │  initSchemaLogicRules() 호출                        │        │
│  │     ↓                                               │        │
│  │  cachedRules === null? ✓                            │        │
│  │     ↓                                               │        │
│  │  fetch() → YAML 파일 로드 ⏱️                        │        │
│  │     ↓                                               │        │
│  │  yaml.load() → 파싱 ⏱️                              │        │
│  │     ↓                                               │        │
│  │  cachedRules = 결과                                 │        │
│  │     ↓                                               │        │
│  │  return cachedRules                                 │        │
│  └────────────────────────────────────────────────────┘        │
│                                                                  │
│  두 번째 이후 호출:                                               │
│  ┌────────────────────────────────────────────────────┐        │
│  │  getSchemaLogicRules() 호출                         │        │
│  │     ↓                                               │        │
│  │  cachedRules === null? ✗                            │        │
│  │     ↓                                               │        │
│  │  return cachedRules (즉시 반환!) ⚡                 │        │
│  └────────────────────────────────────────────────────┘        │
│                                                                  │
│  장점:                                                            │
│  • 파일을 한 번만 읽음                                            │
│  • 이후 호출은 매우 빠름                                          │
│  • 네트워크/파일 IO 최소화                                        │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 4.4 조건 평가 엔진

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                  │
│  evaluateSectionCondition() 상세 동작                            │
│  ══════════════════════════════════                              │
│                                                                  │
│  입력:                                                            │
│  • condition (YAML 규칙)                                         │
│  • field (필드 정보)                                              │
│                                                                  │
│  ┌────────────────────────────────────────────────┐            │
│  │  condition.type을 확인                          │            │
│  │     ↓                                           │            │
│  │  switch (condition.type) {                      │            │
│  │                                                  │            │
│  │    case "has-explicit-group":                   │            │
│  │      ┌─────────────────────────────┐           │            │
│  │      │ field.ui?.group 존재?        │           │            │
│  │      │   YES → true                 │           │            │
│  │      │   NO  → false                │           │            │
│  │      └─────────────────────────────┘           │            │
│  │                                                  │            │
│  │    case "visible-types-include-all":            │            │
│  │      ┌─────────────────────────────┐           │            │
│  │      │ visibleTypes 추출            │           │            │
│  │      │   ↓                          │           │            │
│  │      │ condition.types의 모든       │           │            │
│  │      │ 항목이 포함되어 있는가?      │           │            │
│  │      │   ALL YES → true             │           │            │
│  │      │   OTHERWISE → false          │           │            │
│  │      └─────────────────────────────┘           │            │
│  │                                                  │            │
│  │    case "visible-types-include-any":            │            │
│  │      ┌─────────────────────────────┐           │            │
│  │      │ condition.types 중           │           │            │
│  │      │ 하나라도 포함?               │           │            │
│  │      │   ANY YES → true             │           │            │
│  │      │   NONE → false               │           │            │
│  │      └─────────────────────────────┘           │            │
│  │                                                  │            │
│  │    case "always":                                │            │
│  │      ┌─────────────────────────────┐           │            │
│  │      │ return true                  │           │            │
│  │      └─────────────────────────────┘           │            │
│  │                                                  │            │
│  │  }                                               │            │
│  └────────────────────────────────────────────────┘            │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 5. 참고 자료

### 5.1 빠른 참조 카드

```
┌─────────────────────────────────────────────────────────────────┐
│  YAML 문법 빠른 참조                                             │
│  ═══════════════════════                                         │
│                                                                  │
│  기본 구조:                                                       │
│    키: 값                                                         │
│                                                                  │
│  리스트:                                                          │
│    항목들:                                                        │
│      - 항목1                                                      │
│      - 항목2                                                      │
│                                                                  │
│  중첩:                                                            │
│    부모:                                                          │
│      자식: 값                                                     │
│                                                                  │
│  주석:                                                            │
│    # 이것은 주석입니다                                            │
│                                                                  │
│  문자열 (특수문자 포함):                                          │
│    이름: "홍길동: 개발자"                                         │
│                                                                  │
│  여러 줄 문자열:                                                  │
│    설명: |                                                        │
│      첫 번째 줄                                                   │
│      두 번째 줄                                                   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 5.2 조건 타입 목록

#### 조건 타입 (Condition Types)

| # | 조건 타입 | 설명 | 사용 예시 |
|---|-----------|------|-----------|
| 1 | `has-explicit-group` | `field.ui.group`이 명시되어 있는지 확인 | 명시적 그룹이 있는 필드 우선 처리 |
| 2 | `no-visible-when` | `field.ui.visibleWhen`이 없는지 확인 | 조건 없이 항상 표시되는 공통 필드 |
| 3 | `visible-types-include-all` | `condition.types`의 **모든** 항목이 포함되어 있는지 | TENSTR과 COMPTR 둘 다 필요한 경우 |
| 4 | `visible-types-include-any` | `condition.types` 중 **하나라도** 포함되어 있는지 | BEAM, TRUSS 중 하나만 있어도 표시 |
| 5 | `visible-types-exact` | `condition.types`와 **정확히 일치**하는지 | TENSTR만 정확히 있는 경우 |
| 6 | `visible-types-match` | `includes`/`excludes`/`fields` 조건 모두 만족하는지 | 복잡한 조건 조합 (포함+제외+필드) |
| 7 | `visible-types-multiple` | 여러 개의 타입이 있는지 (개수 확인) | 2개 이상의 타입이 있을 때 |
| 8 | `always` | 항상 `true` 반환 (폴백 규칙) | 다른 모든 규칙에 매칭되지 않을 때 |

#### 조건 타입별 파라미터

| 조건 타입 | 필수 파라미터 | 선택 파라미터 | 예시 |
|-----------|---------------|---------------|------|
| `has-explicit-group` | - | - | `{ type: "has-explicit-group" }` |
| `no-visible-when` | - | - | `{ type: "no-visible-when" }` |
| `visible-types-include-all` | `types: string[]` | - | `{ type: "...", types: ["TENSTR", "COMPTR"] }` |
| `visible-types-include-any` | `types: string[]` | - | `{ type: "...", types: ["BEAM", "TRUSS"] }` |
| `visible-types-exact` | `types: string[]` | - | `{ type: "...", types: ["WALL"] }` |
| `visible-types-match` | - | `includes`, `excludes`, `fields` | `{ type: "...", includes: ["WALL"], excludes: ["BEAM"] }` |
| `visible-types-multiple` | - | `minCount: number` | `{ type: "...", minCount: 2 }` |
| `always` | - | - | `{ type: "always" }` |

### 5.3 액션 타입 목록

#### 액션 타입 (Action Types)

| # | 액션 타입 | 설명 | 결과 예시 |
|---|-----------|------|-----------|
| 1 | `use-explicit-group` | `field.ui.group` 값을 그대로 사용 | `"Common Keys"` → `"Common Keys"` |
| 2 | `assign-section` | `action.section`에 지정된 이름 사용 | 지정된 섹션 → `"Tension only"` |
| 3 | `join-type-labels` | 여러 타입의 레이블을 조합<br>`separator`로 구분 (기본값: `", "`) | `["BEAM", "TRUSS"]` → `"Beam, Truss"` |

#### 액션 타입별 파라미터

| 액션 타입 | 필수 파라미터 | 선택 파라미터 | 예시 |
|-----------|---------------|---------------|------|
| `use-explicit-group` | - | - | `{ type: "use-explicit-group" }` |
| `assign-section` | `section: string` | - | `{ type: "assign-section", section: "Wall" }` |
| `join-type-labels` | - | `separator: string` | `{ type: "join-type-labels", separator: " / " }` |

#### 조건-액션 조합 예시

| 조건 | 액션 | 사용 케이스 |
|------|------|-------------|
| `has-explicit-group` | `use-explicit-group` | 개발자가 명시한 그룹을 우선 사용 |
| `visible-types-include-all` | `assign-section` | 특정 조합일 때 고정된 섹션 할당 |
| `visible-types-multiple` | `join-type-labels` | 여러 타입을 사람이 읽기 쉽게 표시 |
| `always` | `assign-section` | 폴백으로 기본 섹션 할당 |

### 5.4 실전 팁

```
┌─────────────────────────────────────────────────────────────────┐
│  YAML 작성 실전 팁                                               │
│  ═══════════════════                                             │
│                                                                  │
│  ✅ DO (권장)                                                     │
│  • 들여쓰기는 항상 스페이스 2칸                                   │
│  • 규칙은 구체적인 것부터 일반적인 순서로                         │
│  • 마지막에는 항상 "always" 규칙 (폴백)                          │
│  • 주석으로 설명 추가                                             │
│  • 의미 있는 섹션 이름 사용                                       │
│                                                                  │
│  ❌ DON'T (비권장)                                                │
│  • 탭 사용하지 않기                                               │
│  • 콜론(:) 뒤 공백 빼먹지 않기                                    │
│  • 들여쓰기 불일치 주의                                           │
│  • 너무 복잡한 조건 피하기                                        │
│  • 중복 규칙 만들지 않기                                          │
│                                                                  │
│  💡 디버깅 팁                                                     │
│  • 브라우저 개발자 도구 콘솔 확인                                 │
│  • YAML 파싱 에러는 줄 번호 표시됨                               │
│  • 규칙 순서가 중요 (첫 매칭 규칙이 적용됨)                      │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### 5.5 문제 해결 가이드

```
┌─────────────────────────────────────────────────────────────────┐
│  자주 발생하는 문제와 해결책                                      │
│  ═══════════════════════════                                     │
│                                                                  │
│  문제 1: YAML 파일이 로드되지 않아요                             │
│  ┌───────────────────────────────────────────────┐             │
│  │ 확인 사항:                                     │             │
│  │ • 파일 경로가 올바른지                         │             │
│  │ • 파일 확장자가 .yaml인지                      │             │
│  │ • 브라우저 콘솔에 에러 메시지 확인             │             │
│  └───────────────────────────────────────────────┘             │
│                                                                  │
│  문제 2: 섹션이 예상대로 분류되지 않아요                         │
│  ┌───────────────────────────────────────────────┐             │
│  │ 확인 사항:                                     │             │
│  │ • sectionRules 순서 확인                       │             │
│  │ • 조건이 너무 포괄적인지 확인                  │             │
│  │ • 콘솔에 어떤 규칙이 매칭되었는지 로그 확인    │             │
│  └───────────────────────────────────────────────┘             │
│                                                                  │
│  문제 3: YAML 파싱 에러가 발생해요                               │
│  ┌───────────────────────────────────────────────┐             │
│  │ 확인 사항:                                     │             │
│  │ • 들여쓰기가 일정한지 (스페이스 2칸)           │             │
│  │ • 콜론(:) 뒤에 공백이 있는지                   │             │
│  │ • 따옴표("")가 제대로 닫혔는지                 │             │
│  │ • 리스트 하이픈(-) 뒤에 공백이 있는지          │             │
│  └───────────────────────────────────────────────┘             │
│                                                                  │
│  문제 4: 캐시 때문에 변경사항이 반영되지 않아요                  │
│  ┌───────────────────────────────────────────────┐             │
│  │ 해결 방법:                                     │             │
│  │ • 브라우저 완전히 새로고침 (Ctrl+Shift+R)      │             │
│  │ • 개발자 도구에서 캐시 비우기                  │             │
│  │ • clearSchemaLogicCache() 호출                 │             │
│  └───────────────────────────────────────────────┘             │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 마치며

이 가이드를 통해 YAML 기반 스키마 정의 시스템을 이해하고 활용할 수 있게 되었기를 바랍니다!

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                  │
│           🎉 축하합니다! 이제 당신도 YAML 마스터!                │
│           ═══════════════════════════════════════               │
│                                                                  │
│  배운 내용:                                                       │
│  ✓ YAML 기본 문법                                                │
│  ✓ 섹션 규칙 작성                                                │
│  ✓ 조건과 액션 정의                                              │
│  ✓ 시스템 동작 원리                                              │
│                                                                  │
│  이제 할 수 있는 것:                                              │
│  🔧 새로운 섹션 추가                                             │
│  🔧 섹션 순서 변경                                               │
│  🔧 타입 레이블 수정                                             │
│  🔧 검증 규칙 추가                                               │
│                                                                  │
│  모두 코드 수정 없이 YAML만으로!                                 │
│                                                                  │
│           Happy YAML-ing! 🚀                                     │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

**문서 버전**: 1.0  
**최종 업데이트**: 2026-01-14  
**작성자**: API Verification Team  
**연락처**: support@example.com

